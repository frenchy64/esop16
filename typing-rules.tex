\begin{figure*}
\begin{mathpar}
\infer [T-Local]
{ \inpropenv {\propenv{}} {\isprop {\t{}} {\x{}}}
  \\
  \s{} = {\falsydiff} }
{ \judgementfillcol {\propenv{}} 
                   {\hastype {\x{}} {\t{}}}
                   {\filterset {{\notprop {\s{}} {\x{}}}} {{\isprop {\s{}} {\x{}}}}}
                   {\x{}}
                   }

\infer [T-Const]
{}
{ \judgement {\propenv{}} 
             {\hastype {\const{}} {\constanttype{\const{}}}}
             {\filterset {\topprop{}}{\botprop{}}}
             {\emptyobject{}}
                   }

\infer [T-True]
{}
{ \judgementfillcol {\propenv{}}
      {{\hastype {\true{}} {\True{}}}}
      {{\filterset {\topprop{}} {\botprop{}}}}
      {\emptyobject{}}
    }

\infer [T-False]
{}
{ \judgementfillcol {\propenv{}}
      {{\hastype {\false{}} {\False{}}}}
      {\filterset {\botprop{}} {\topprop{}}}
    {\emptyobject{}}
   }

\infer [T-Nil]
{}
{ \judgementfillcol {\propenv{}} 
      {{\hastype {\nil{}} {\Nil{}}}} 
      {\filterset {\botprop{}} {\topprop{}}}
      {\emptyobject{}} 
    }

\infer [T-Do]
{ 
  \judgement {\propenv{}} 
             {\hastype {\e1} {\t1}} 
             {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop1}}} 
             {\object{1}}
\\\\
\judgement {\propenv{}, {\trdiff {\orprop {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}}}
           {\hastype {\e{}} {\t{}}} 
           {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} 
           {\object{}}
  }
{ \judgement
    {\propenv{}} 
    {\hastype {\doexp {\e1} {\e{}}} {\t{}}} 
    {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} {\object{}} 
             }

\infer [T-If]
{ \judgement {\propenv{}} {\hastype {\e1} {\t{1}}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}
                 {\object{1}} 
             \\\\
  \judgement {\propenv{}, {\thenprop {\prop{1}}}}
                 {\hastype {\e2} {\t{}}} {\filterset {\thenprop {\prop{2}}} {\elseprop {\prop{2}}}}
                 {\object{}}
  \\\\
  \judgement {\propenv{}, {\elseprop {\prop{1}}}}
                 {\hastype {\e3} {\t{}}} {\filterset {\thenprop {\prop{3}}} {\elseprop {\prop{3}}}}
                 {\object{}}
             }
{ \judgement {\propenv{}} {\hastype {\ifexp {\e1} {\e2} {\e3}} {\t{}}} 
                 {\filterset {\orprop {\thenprop {\prop{2}}} {\thenprop {\prop{3}}}} 
                             {\orprop {\elseprop {\prop{2}}} {\elseprop {\prop{3}}}}}
                 {\object{}} }

\infer [T-Let]
{ \judgement {\propenv{}} {\hastype {\e{1}} {\s{}}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}
             {\object{1}}
             \\\\
             \propp{} = {\impprop {\notprop {\falsydiff{}} {\x{}}} {\thenprop {\prop{1}}}}
             \\\\
             \proppp{} = {\impprop {\isprop {\falsydiff{}} {\x{}}} {\elseprop {\prop{1}}}}
  \\\\
  \judgement
       {\propenv{}, {\isprop {\s{}} {\x{}}},
         {\propp{}},
         {\proppp{}}}
             {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}} 
             }
{ \judgement {\propenv{}} {\hastype {\letexp {\x{}} {\e{1}} {\e{}}} {\t{}}}
             {\replacefor {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
                          {\object{1}}
                          {\x{}}}
             {\replacefor {\object{}} 
                          {\object{1}}
                          {\x{}}}
             }

\infer [T-App]
{ \judgement {\propenv{}} {\hastype {\e{}} {\ArrowOne {\x{}} {\s{}}
                                                       {\t{}}
                                                       {\filterset {\thenprop {\prop{f}}}
                                                                   {\elseprop {\prop{f}}}}
                                                       {\object{f}}}}
                {\filterset {\thenprop {\prop{}}}
                            {\elseprop {\prop{}}}}
                {\object{}}
  \\\\
  \judgement {\propenv{}}
                 {\hastype {\ep{}} {\s{}}}
                 {\filterset {\thenprop {\propp{}}}
                             {\elseprop {\propp{}}}}
                 {\objectp{}} 
}
{ \judgementfillcol {\propenv{}} {\hastype {\appexp {\e{}} {\ep{}}}
                                        {\replacefor {\t{}}
                                                     {\objectp{}}
                                                     {\x{}}}}
                 {\replacefor {\filterset {\thenprop {\prop{f}}}
                                          {\elseprop {\prop{f}}}}
                              {\objectp{}}
                              {\x{}}}
                 {\replacefor {\object{f}}
                              {\objectp{}}
                              {\x{}}}
}
                 
                              


\infer [T-Abs]
{ \judgement {\propenv{}, {\isprop {\s{}} {\x{}}}}
            {\hastype {\e{}} {\t{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\object{}}}
{ \judgement {\propenv{}} {\hastype {\abs {\x{}} {\s{}} {\e{}}}
                                           {\ArrowOne {\x{}} {\s{}}
                                                      {\t{}}
                                                      {\filterset {\thenprop {\prop{}}}
                                                                  {\elseprop {\prop{}}}}
                                                      {\object{}}}}
                {\filterset {\topprop{}}
                            {\botprop{}}}
                {\emptyobject{}}}

\infer [T-Clos]
{ \exists {\propenv{}}. \satisfies{\openv{}}{\propenv{}}
  \ \text{and}\ 
\judgement {\propenv{}} {\hastype {\abs {\x{}} {\t{}} {\e{}}} {\s{}}}
                 {\filterset {\thenprop {\prop{}}}
                             {\elseprop {\prop{}}}}
                 {\object{}}
              }
{ \judgement {}
            {\hastype {\closure {\openv{}} {\abs {\x{}} {\t{}} {\e{}}}} 
                      {\s{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\object{}}}

\infer [T-Error]
{}
{ \judgement {\propenv{}} {\hastype {\errorvalv} {\Bot}}
            {\filterset {\botprop{}} {\botprop{}}}
           {\emptyobject{}}}

\infer [T-Subsume]
{ \judgement {\propenv{}} {\hastype {\e{}} {\t{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\object}
\\\\
\inpropenv {\propenv{}, {\thenprop {\prop{}}}} {\thenprop {\propp{}}}
\\
\inpropenv {\propenv{}, {\elseprop {\prop{}}}} {\elseprop {\propp{}}}
\\\\
\inpropenv {} {\issubtype {\t{}} {\tp{}}}
\\
\inpropenv {} {\issubtype {\object{}} {\objectp{}}}
}
{ \judgement {\propenv{}} {\hastype {\e{}} {\tp{}}}
             {\filterset {\thenprop {\propp{}}}
                         {\elseprop {\propp{}}}}
             {\objectp{}}}
\end{mathpar}
\caption{Standard Typing Rules}
\end{figure*}


\begin{figure*}
\begin{mathpar}

\infer [T-NewStatic]
{ 
  \overrightarrow{
\javatotc {\classhint{i}}
          {\t{i}}
          }
  \\\\
  \javatotc {\classhint{}}
            {\t{}}
  \\
  \overrightarrow{
  \judgementtwo {\propenv{}}
                    {\hastype {\e{i}} {\t{i}}}
                  }
           }
{ \judgementfillcol {\propenv{}} {\hastype {\newstaticexp {\overrightarrow{\classhint{i}}} {\classhint{}} 
                                                          {\class{}} {\overrightarrow{\e{i}}}} {\t{}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}
             }

\infer [T-FieldStatic]
{ \javatotc {\classhint{1}} {\class{}}
             \\\\
  \javatotcnil {\classhint{2}} {\t{}}
  \\\\
  \judgementtwo {\propenv{}} {\hastype {\e{1}} {\class{}}}
           }
{ \judgement {\propenv{}} {\hastype {\fieldstaticexp {\classhint{1}} {\classhint{2}} {\fld{}} {\e{1}}} {\t{}}}
             {\filterset {\topprop{}} {\topprop}}
             {\emptyobject{}}}

\infer [T-MethodStatic]
{ 
  \overrightarrow{\javatotc {\classhint{i}} {\t{i}}}
             \\
             \javatotc {\classhint{1}} {\class{}}
             \\\\
             \javatotcnil {\classhint{2}} {\t{}}
             \\\\
  \judgementtwo {\propenv{}} {\hastype {\e{}} {\class{}}}
             \\
             \overrightarrow{
  \judgementtwo {\propenv{}} {\hastype {\e{i}} {\t{i}}}
                  }
           }
{ \judgementfillcol {\propenv{}} {\hastype {\methodstaticexp {\classhint{1}} 
                                                            {\overrightarrow {\classhint{i}}} 
                                                            {\classhint{2}}
                                                            {\mth{}} {\e{}} {\overrightarrow{\e{i}}}}
                                    {\t{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\emptyobject{}}}

\infer [T-Class]
{}
{ \judgement {\propenv{}} {\hastype{\class{}}{\Value{\class{}}}}{\filterset{\topprop{}}{\botprop{}}}{\emptyobject{}}}

\infer [T-Instance]
{}
{ \judgement {\propenv{}} {\hastype{\classvalue{\classhint{}} {\overrightarrow {\classfieldpair{\fld{}} {\v{}}}}}{\class{}}}{\filterset{\topprop{}}{\botprop{}}}{\emptyobject{}}}

\end{mathpar}
\caption{Java Interop Typing Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}

\infer [T-DefMulti]
{ \s{} = {\ArrowOne {\x{}} {\t{}} {\tp{}}
                          {\filterset {\thenprop {\prop{}}}
                                      {\elseprop {\prop{}}}}
                          {\object{}}}
                          \\
  \sp{} = {\ArrowOne {\x{}} {\t{}} {\tpp{}}
                          {\filterset {\thenprop {\propp{}}}
                                      {\elseprop {\propp{}}}}
                          {\objectp{}}}
                \\\\
\judgementtwo {\propenv{}} {\hastype {\e{}} {\sp{}}}
}
{
  \judgement {\propenv{}}  
      {\hastype {\createmultiexp {\s{}}
                                 {\e{}}} 
                {\MultiFntype {\s{}} {\sp{}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject{}}
}

\infer [T-DefMethod]
{
  \t{m} = {\ArrowOne {\x{}} {\t{}} {\s{}}
                                    {\filterset {\thenprop {\prop{}}}
                                                {\elseprop {\prop{}}}}
                                    {\object{}}}
\\
\t{d} = {\ArrowOne {\x{}} {\t{}} {\sp{}}
                   {\filterset {\thenprop {\propp{}}}
                               {\elseprop {\propp{}}}}
                   {\objectp{}}}
             \\\\
\judgementtwo {\propenv{}}
                  {\hastype {\e{m}} {\MultiFntype {\t{m}} {\t{d}}}}
\\
  \isacompare{\sp{}}{\objectp{}}{\t{v}}{\filterset {\thenprop {\proppp{}}} {\elseprop {\proppp{}}}}
\\\\
\judgementtwo {\propenv{}}
           {\hastype {\e{v}} {\t{v}}}
           \\
\judgement {\propenv{}, {\isprop{\t{}} {\x{}}}, {\thenprop {\proppp{}}}}
           {\hastype {\e{b}} {\s{}}}
           {\filterset {\thenprop {\prop{}}}
                       {\elseprop {\prop{}}}}
           {\object{}}
}
{ \judgementfillcol {\propenv{}} {\hastype {\extendmultiexp {\e{m}} {\e{v}} 
                                                            {\abs {\x{}} {\t{}} {\e{b}}}}
                                           {\MultiFntype {\t{m}} {\t{d}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject{}}
}

\infer [T-IsA]
{
  \judgement {\propenv{}} {\hastype {\e{}} {\s{}}}
             {\filterset {\thenprop {\propp{}}}
                         {\elseprop {\propp{}}}}
                       {\object{}}
  \\
  \judgementtwo
             {\propenv{}} {\hastype {\ep{}} {\t{}}}
             \\
  \isacompare{\s{}}{\object{}}{\t{}}{\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
}
{ \judgement {\propenv{}} {\hastype {\isaapp {\e{}} {\ep{}}}
                                    {\Boolean{}}}
             {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\emptyobject}}

\infer [T-Multi]
{ \judgementtwo {} {\hastype {\v{}} {\t{}}}
  \\
  \overrightarrow{\judgementtwo{}{\hastype{\v{k}}{\Top{}}}}
  \\
  \overrightarrow{\judgementtwo{}{\hastype{\v{v}}{\s{}}}}
}
{ \judgement {}
  {\hastype {\multi {\v{}} {\curlymapvaloverright{\v{k}}{\v{v}}}}
                      {\MultiFntype {\s{}} {\t{}}}}
             {\filterset {\topprop{}} {\botprop{}}}
           {\emptyobject{}}}

\end{mathpar}
\caption{Multimethod Typing Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}

%\infer [T-Get]
%{ \judgementtwo {\propenv{}} {\hastype {\e{m}} {\Map {\t{k}}{\t{v}}}}
%  \\
%  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\Top}}}
%{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}} {\Union{\t{v}}{\nil{}}}}
%             {\filterset {\topprop{}} {\topprop{}}}
%           {\emptyobject{}}}
%
%\infer [T-Assoc]
%{ 
%  \judgementtwo {\propenv{}} {\hastype {\e{m}} {\Map{\t{k}}{\t{v}}}}
%  \\
%  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\t{k}}}
%  \\
%  \judgementtwo {\propenv{}} {\hastype {\e{v}} {\t{v}}}
%}
%{ \judgement {\propenv{}} 
%             {\hastype {\assocexp {\e{m}} {\e{k}} {\e{v}}} {\Map {\t{k}}{\t{v}}}}
%             {\filterset {\topprop{}} {\botprop{}}}
%             {\emptyobject{}}
%}

\infer [T-HMap]
{ \overrightarrow{\judgementtwo {} {\hastype{\v{k}}{\Value \k{}}}}\\
  \overrightarrow{\judgementtwo {} {\hastype{\v{v}}{\t{v}}}}\\
  \mandatory{} = \mandatorysetoverright{\k{}}{\t{v}}
}
{ \judgement {}
             {\hastype {\curlymapvaloverright{\v{k}}{\v{v}}}
                       {\HMapc {\mandatory{}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject{}}}

\infer [T-Kw]
{}
{ \judgementfillcol {\propenv{}} 
      {\hastype {\k{}} {\Value{\k{}}}}
      {\filterset {\topprop{}}{\botprop{}}}
      {\emptyobject{}} 
    }

\infer [T-GetHMap]
{ \judgement {\propenv{}} 
  {\hastype {\e{m}} {\Unionsplice {{\overrightarrow {\HMapgeneric {\mandatory{}} {\absent{}}}}^i}}}
           {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
           {\object{}}
           \\\\
  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             \\
             {\overrightarrow{\inmandatory{\k{}}{\t{}}{\mandatory{}}}}^i
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}} {\Unionsplice {{\overrightarrow {\t{}}}^i}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\replacefor {\path {\keype{k}} {\x{}}}
                          {\object{}}
                          {\x{}}}
                                  }

\infer [T-GetHMapAbsent]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapgeneric {\mandatory{}} {\absent}}}
           {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
           {\object{}}
         \\\\
  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             \\
             {\inabsent{\k{}}{\absent{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\Nil{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\replacefor
               {\path {\keype{k}} {\x{}}}
                          {\object{}}
                          {\x{}}}
                        }

\infer [T-GetHMapPartialDefault]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapp {\mandatory{}} {\absent}}}
           {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
           {\object{}}
         \\\\
  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             \\
             {\notinmandatory{\k{}}{\t{}}{\mandatory{}}}
             \\
             {\notinabsent{\k{}}{\absent{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\Top{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\replacefor
               {\path {\keype{k}} {\x{}}}
                          {\object{}}
                          {\x{}}}
                        }

\infer [T-AssocHMap]
{ 
  \judgementtwo {\propenv{}} {\hastype {\e{m}} {\HMapgeneric {\mandatory{}} {\absent}}}
  \\
  \judgementtwo {\propenv{}} {\hastype {\e{k}} {\Value{\k{}}}}
  \\
  \judgementtwo {\propenv{}} {\hastype {\e{v}} {\t{}}}
  \\
  {\k{}} \not\in {\absent{}}
}
{ \judgement {\propenv{}} 
             {\hastype {\assocexp {\e{m}} {\e{k}} {\e{v}}}
                       {\HMapgeneric {\extendmandatoryset {\mandatory{}}{\k{}}{\t{}}} {\absent}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject{}}
}

\end{mathpar}
\caption{Map Typing Rules}
\end{figure*}
