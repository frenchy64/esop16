\begin{figure*}
\begin{mathpar}
\infer [T-Local]
{ \inpropenv {\propenv{}} {\isprop {\t{}} {\x{}}}
  \\
  \s{} = {\falsydiff} }
{ \judgementfillcol {\propenv{}} 
                   {\hastype {\x{}} {\t{}}}
                   {\filterset {{\notprop {\s{}} {\x{}}}} {{\isprop {\s{}} {\x{}}}}}
                   {\x{}}
                   }

\infer [T-True]
{}
{ \judgementfillcol {\propenv{}}
      {{\hastype {\true{}} {\True{}}}}
      {{\filterset {\topprop{}} {\botprop{}}}}
      {\emptyobject{}}
    }

\infer [T-False]
{}
{ \judgementfillcol {\propenv{}}
      {{\hastype {\false{}} {\False{}}}}
      {\filterset {\botprop{}} {\topprop{}}}
    {\emptyobject{}}
   }

\infer [T-Nil]
{}
{ \judgementfillcol {\propenv{}} 
      {{\hastype {\nil{}} {\Nil{}}}} 
      {\filterset {\botprop{}} {\topprop{}}}
      {\emptyobject{}} 
    }

\infer [T-Do]
{ \judgementsevcol {\mmenv} {\taenv} {\propenv{}} {\hastype {\e1} {\t1}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop1}}} {\object{1}} {\mmenv{}} 
\\\\
\judgementsevcol {\mmenv{}}
                  {\taenv}
                   {\propenv{}, {\trdiff {\orprop {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}}}
                   {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} 
                   {\object{}}
                   {\mmenv{}}
  }
{ \judgementsevcol 
  {\mmenv{}}
  {\taenv{}}
    {\propenv{}} {\hastype {\doexp {\e1} {\e{}}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}} {\object{}} 
       {\mmenv{}}
             }

\infer [T-If]
{ \judgementfillcol {\propenv{}} {\hastype {\e1} {\t{1}}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}
                 {\object{1}} 
             \\\\
  \judgementfillcol {\propenv{}, {\thenprop {\prop{1}}}}
                 {\hastype {\e2} {\t{}}} {\filterset {\thenprop {\prop{2}}} {\elseprop {\prop{2}}}}
                 {\object{}}
  \\\\
  \judgementfillcol {\propenv{}, {\elseprop {\prop{1}}}}
                 {\hastype {\e3} {\t{}}} {\filterset {\thenprop {\prop{3}}} {\elseprop {\prop{3}}}}
                 {\object{}}
             }
{ \judgementfillcol {\propenv{}} {\hastype {\ifexp {\e1} {\e2} {\e3}} {\t{}}} 
                 {\filterset {\orprop {\thenprop {\prop{2}}} {\thenprop {\prop{3}}}} 
                             {\orprop {\elseprop {\prop{2}}} {\elseprop {\prop{3}}}}}
                 {\object{}} }

\infer [T-Let]
{ \judgementfillcol {\propenv{}} {\hastype {\e{1}} {\s{}}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}
             {\object{1}}
             \\\\
             \propp{} = {\impprop {\notprop {\falsydiff{}} {\x{}}} {\thenprop {\prop{1}}}}
             \\\\
             \proppp{} = {\impprop {\isprop {\falsydiff{}} {\x{}}} {\elseprop {\prop{1}}}}
  \\\\
  \judgementfillmmcol 
      {\taenv{}, {\hastype {\x{}} {\tatype{}}}}
       {\propenv{}, {\isprop {\s{}} {\x{}}},
         {\propp{}},
         {\proppp{}}}
             {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}} 
             }
{ \judgementfillcol {\propenv{}} {\hastype {\letexp {\x{}} {\e{1}} {\e{}}} {\t{}}}
             {\replacefor {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
                          {\object{1}}
                          {\x{}}}
             {\replacefor {\object{}} 
                          {\object{1}}
                          {\x{}}}
             }

\infer [T-App]
{ \judgementfillcol {\propenv{}} {\hastype {\e{}} {\ArrowOne {\x{}} {\s{}}
                                                       {\t{}}
                                                       {\filterset {\thenprop {\prop{f}}}
                                                                   {\elseprop {\prop{f}}}}
                                                       {\object{f}}}}
                {\filterset {\thenprop {\prop{}}}
                            {\elseprop {\prop{}}}}
                {\object{}}
  \\\\
  \judgementfillcol {\propenv{}}
                 {\hastype {\ep{}} {\s{}}}
                 {\filterset {\thenprop {\propp{}}}
                             {\elseprop {\propp{}}}}
                 {\objectp{}} 
}
{ \judgementfillcol {\propenv{}} {\hastype {\appexp {\e{}} {\ep{}}}
                                        {\replacefor {\t{}}
                                                     {\objectp{}}
                                                     {\x{}}}}
                 {\replacefor {\filterset {\thenprop {\prop{f}}}
                                          {\elseprop {\prop{f}}}}
                              {\objectp{}}
                              {\x{}}}
                 {\replacefor {\object{f}}
                              {\objectp{}}
                              {\x{}}}
}
                 
                              


\infer [T-Abs]
{ \judgementfillcol {\propenv{}, {\isprop {\s{}} {\x{}}}}
            {\hastype {\e{}} {\t{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\object{}}}
{ \judgementfillcol {\propenv{}} {\hastype {\abs {\x{}} {\s{}} {\e{}}}
                                           {\ArrowOne {\x{}} {\s{}}
                                                      {\t{}}
                                                      {\filterset {\thenprop {\prop{}}}
                                                                  {\elseprop {\prop{}}}}
                                                      {\object{}}}}
                {\filterset {\topprop{}}
                            {\botprop{}}}
                {\emptyobject{}}}

\infer [T-Subsume]
{ \judgementfillcol {\propenv{}} {\hastype {\e{}} {\t{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\object}
\\\\
\inpropenv {\propenv{}, {\thenprop {\prop{}}}} {\thenprop {\propp{}}}
\\
\inpropenv {\propenv{}, {\elseprop {\prop{}}}} {\elseprop {\propp{}}}
\\\\
\inpropenv {} {\issubtype {\t{}} {\tp{}}}
\\
\inpropenv {} {\issubtype {\object{}} {\objectp{}}}
}
{ \judgementfillcol {\propenv{}} {\hastype {\e{}} {\tp{}}}
             {\filterset {\thenprop {\propp{}}}
                         {\elseprop {\propp{}}}}
             {\objectp}}
\end{mathpar}
\caption{Standard Typing Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}

\infer [T-LocalHint]
{ \inpropenv {\propenv{}} {\isprop {\t{}} {\x{}}}
  \\
  \s{} = {\falsydiff} }
{ \judgementfillcol {\propenv{}} 
                   {\hastype {\hinted {\classhint{}} {\x{}}} {\t{}}}
                   {\filterset {{\notprop {\s{}} {\x{}}}} {{\isprop {\s{}} {\x{}}}}}
                   {\x{}}
                   }

\infer [T-LetHint]
{ \judgementfillcol {\propenv{}} {\hastype {\e{1}} {\s{}}} {\filterset {\thenprop {\prop{1}}} {\elseprop {\prop{1}}}}
             {\object{1}}
             \\\\
             \propp{} = {\impprop {\notprop {\falsydiff{}} {\x{}}} {\thenprop {\prop{1}}}}
             \\\\
             \proppp{} = {\impprop {\isprop {\falsydiff{}} {\x{}}} {\elseprop {\prop{1}}}}
  \\\\
  \judgementfillmmcol 
      {\taenv{}, {\hastype {\x{}} {\tatype{}}}}
       {\propenv{}, {\isprop {\s{}} {\x{}}},
         {\propp{}},
         {\proppp{}}}
             {\hastype {\e{}} {\t{}}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}} 
             }
{ \judgementfillcol {\propenv{}} {\hastype {\letexp {\hinted{\classhint{}{\x{}}}} {\e{1}} {\e{}}} {\t{}}}
             {\replacefor {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
                          {\object{1}}
                          {\x{}}}
             {\replacefor {\object{}} 
                          {\object{1}}
                          {\x{}}}
             }

\end{mathpar}
\caption{Type Hint Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}

\infer [T-NewStatic]
{ 
  \overrightarrow{
\javatotc {\classhint{i}}
          {\t{i}}
          }
  \\\\
  \javatotc {\classhint{2}}
            {\t{}}
  \\\\
  \overrightarrow{
  \judgementfillcol {\propenv{}}
                    {\hastype {\e{i}} {\t{i}}}
                    {\filterset {\thenprop {\prop{i}}} {\elseprop {\prop{i}}}}
                    {\object{i}}
                  }
           }
{ \judgementfillcol {\propenv{}} {\hastype {\newstaticexp {\overrightarrow{\classhint{i}}} {\classhint{2}} 
                                                          {\class{}} {\overrightarrow{\e{i}}}} {\t{}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}
             }

\infer [T-FieldStatic]
{ \javatotc {\classhint{1}} {\class{}}
             \\\\
  \javatotcnil {\classhint{2}} {\t{}}
  \\\\
  \judgementfillcol {\propenv{}} {\hastype {\e{}} {\class{}}}
                    {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}}
           }
{ \judgementfillcol {\propenv{}} {\hastype {\fieldstaticexp {\classhint{1}} {\classhint{2}} {fld} {\e{}}} {\t{}}}
             {\filterset {\topprop{}} {\topprop}}
             {\emptyobject{}}}

\infer [T-MethodStatic]
{ 
  \overrightarrow{\javatotc {\classhint{i}} {\t{i}}}
             \\\\
             \javatotc {\classhint{1}} {\class{}}
             \\\\
             \javatotcnil {\classhint{2}} {\t{}}
             \\\\
  \judgementfillcol {\propenv{}} {\hastype {\e{}} {\class{}}}
                    {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}}
             \\\\
             \overrightarrow{
  \judgementfillcol {\propenv{}} {\hastype {\e{i}} {\t{i}}}
                    {\filterset {\thenprop {\prop{i}}} {\elseprop {\prop{i}}}}
                    {\object{i}}
                  }
           }
{ \judgementfillcol {\propenv{}} {\hastype {\methodstaticexp {\classhint{1}} 
                                                            {\overrightarrow {\classhint{i}}} 
                                                            {\classhint{2}}
                                                            {\mth{}} {\e{}} {\overrightarrow{\e{i}}}}
                                    {\t{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\emptyobject{}}}

\infer [T-InstanceOf]
{ \judgement {\propenv{}} 
             {\hastype {\e{}} {\t{}}}
             {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object}
             \\
             \s{} = {\Instance {\class{}}}
}
{ \judgement {\propenv{}} {\hastype {\instanceapp {\class{}} {\e{}}}
                                    {\Boolean}}
             {\replacefor
               {\filterset {\isprop  {\s{}} {\x{}}}
                           {\notprop {\s{}} {\x{}}}}
               {\object{}}
               {\x{}}}
             {\emptyobject}
}
\\
\infer [T-Throw]
{ \judgementfillcol {\propenv{}} {\hastype {\e{}} {\Throwable}} {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
                 {\object{}}
}
{ \judgementfillcol {\propenv{}} {\hastype {\throwexp {\e{}}} {\Bottom}} {\trdiff {\filterset {\botprop{}} {\botprop{}}}}
             {\emptyobject{}} }

\end{mathpar}
\caption{Java Interop Typing Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}

\infer [T-DefMulti]
{ \t{} = {\ArrowOne {\x{p}} {\t{p}} {\t{m}}
                          {\filterset {\thenprop {\prop{m}}}
                                      {\elseprop {\prop{m}}}}
                          {\object{m}}}
                          \\
  \s{} = {\ArrowOne {\x{p}} {\t{p}} {\t{r}}
                          {\filterset {\thenprop {\prop{d}}}
                                      {\elseprop {\prop{d}}}}
                          {\object{d}}}
                \\\\
\judgementfillcol {\propenv{}} {\hastype {\e{d}} \s{}}
             {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object{}}
}
{
  \judgementsevcol {\mmenv{}} {\taenv{}} {\propenv{}} 
      {\hastype {\createmultiexp {\t{}}
                                 {\e{d}}} 
                {\MultiFntype {\t{}} {\s{}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}
             {\mmenv{}}
}

\infer [T-DefMethod]
{
  \t{m} = {\ArrowOne {\x{}} {\t{}} {\s{b}}
                                    {\filterset {\thenprop {\prop{m}}}
                                                {\elseprop {\prop{m}}}}
                                    {\object{m}}}
\\
\t{d} = {\ArrowOne {\x{}} {\t{}} {\t{r}}
                                    {\filterset {\thenprop {\prop{d}}}
                                                {\elseprop {\prop{d}}}}
                                    {\object{d}}}
             \\\\
\judgementfillcol {\propenv{}}
                  {\hastype {\e{m}} {\MultiFntype {\t{m}} {\t{d}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}
\\\\
\judgementfillcol {\propenv{}}
           {\hastype {\e{v}} {\t{v}}}
           {\filterset {\thenprop {\prop{v}}}
                       {\elseprop {\prop{v}}}}
           {\object{v}}
\\\\
\isacompare {\t{v}} {\x{}} {\t{r}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
\\\\
\judgementfillcol {\propenv{}, {\isprop{\t{}} {\x{}}}, {\thenprop {\prop{}}}}
           {\hastype {\e{b}} {\s{b}}}
           {\filterset {\thenprop {\prop{m}}}
                       {\elseprop {\prop{m}}}}
           {\object{m}}
}
{ \judgementfillcol {\propenv{}} {\hastype {\extendmultiexp {\e{m}} {\e{v}} 
                                                            {\abs {\x{}} {\t{}} {\e{b}}}}
                                           {\MultiFntype {\t{m}} {\t{d}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}
}

\infer [T-Isa]
{ \forall i.\ \judgementfillcol {\propenv{}} {\hastype {\e{i}} {\t{i}}}
             {\filterset {\thenprop {\prop{i}}}
                         {\elseprop {\prop{i}}}}
                       {\object{i}}
  \\\\
\isacompare {\t{1}} {\object{1}} {\t{2}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
}
{ \judgementfillcol {\propenv{}} {\hastype {\isaapp {\e{1}} {\e{2}}}
                                    {\Boolean{}}}
             {\filterset {\thenprop {\prop{}}}
                         {\elseprop {\prop{}}}}
             {\emptyobject}}
\end{mathpar}
\caption{Multimethod Typing Rules}
\end{figure*}

\begin{figure*}
\begin{mathpar}



%\infer [T-KwInvoke]
%{}
%{ TODO }

%{ \judgement {\propenv{}} {\hastype {\e{m}} {\t{m}}}
%             {\filterset {\prop{}} {\prop{}}}
%           {\object{m}}}
%             \\
%  \judgement {\propenv{}} {\hastype {\e{k}} {\t{k}}}
%             {\filterset {\prop{}} {\prop{}}}
%             {\object{}}
             %\\\\
%  \judgement {\propenv{}} {\hastype {\e{d}} {\t{d}}}
%             {\filterset {\prop{}} {\prop{}}}
%             {\object{}}

             %\\
             %\t{k} %= {\Value {k}}
         %}
% invoke complete HMap with present key

\infer [T-GetHMapComplete]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapc {\mandatory{}}}}
           {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
           {\object{m}}
         \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
             \\\\
             {\inmandatory{\k{}}{\t{}}{\mandatory{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}} {\t{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\path {\keype{k}} {\object{m}}}
                                  }

\infer [T-GetHMapCompleteDefault]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapc {\mandatory{}}}}
           {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
           {\object{m}}
         \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
             \\\\
             {\notinmandatory{\k{}}{\t{}}{\mandatory{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\Nil{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\path {\keype{k}} {\object{m}}}}

\infer [T-GetHMapPartial]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapp {\mandatory{}} {\absent}}}
           {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
           {\object{m}}
         \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
             \\\\
             {\inmandatory{\k{}}{\t{}}{\mandatory{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\t{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\path {\keype{k}} {\object{m}}}}
                                  

\infer [T-GetHMapPartialAbsent]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapp {\mandatory{}} {\absent}}}
           {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
           {\object{m}}
         \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
             \\\\
             {\inabsent{\k{}}{\absent{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\Nil{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\path {\keype{k}} {\object{m}}}}

\infer [T-GetHMapPartialDefault]
{ \judgement {\propenv{}} {\hastype {\e{m}} {\HMapp {\mandatory{}} {\absent}}}
           {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
           {\object{m}}
         \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value {k}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
             \\\\
             {\notinmandatory{\k{}}{\t{}}{\mandatory{}}}
             \\\\
             {\notinabsent{\k{}}{\absent{}}}
       }
{ \judgement {\propenv{}} {\hastype {\getexp {\e{m}} {\e{k}}}
                                    {\Top{}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\path {\keype{k}} {\object{m}}}}

\infer [T-KeywordMap]
{ \judgement {\propenv{}} {\hastype {\overrightarrow{{\e{v}}}} {\overrightarrow {{\t{v}}}}}
             {\filterset {\thenprop {\prop{}}} {\elseprop {\prop{}}}}
             {\object}}
{ \judgement {\propenv{}} {\hastype {\curlymap {\overrightarrow{{k_{v}}\ {\e{v}}}}}
  {\HMapc {\mandatoryset {{\overrightarrow{({k_{v}}\ {\t{v}})}}}}}}
             {\filterset {\topprop{}} {\botprop{}}}
             {\emptyobject}}

\infer [T-AssocPartial]
{ 
  \judgement {\propenv{}} {\hastype {\e{m}} {\HMapp {\mandatory{}} {\absent}}}
             {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
             {\object{m}}
  \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value{\k{}}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
  \\\\
  \judgement {\propenv{}} {\hastype {\e{v}} {\t{v}}}
             {\filterset {\thenprop {\prop{v}}} {\elseprop {\prop{v}}}}
             {\object{v}}
}
{ \judgement {\propenv{}} 
             {\hastype {\assocexp {\e{m}} {\e{k}} {\e{v}}}
                       {\HMapp {\extendmandatoryset {\mandatory{}}{\k{}}{\t{v}}} {\absent}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\emptyobject{}}
}

\infer [T-AssocComplete]
{ 
  \judgement {\propenv{}} {\hastype {\e{m}} {\HMapc {\mandatory{}}}}
             {\filterset {\thenprop {\prop{m}}} {\elseprop {\prop{m}}}}
             {\object{m}}
  \\\\
  \judgement {\propenv{}} {\hastype {\e{k}} {\Value{\k{}}}}
             {\filterset {\thenprop {\prop{k}}} {\elseprop {\prop{k}}}}
             {\object{k}}
  \\\\
  \judgement {\propenv{}} {\hastype {\e{v}} {\t{v}}}
             {\filterset {\thenprop {\prop{v}}} {\elseprop {\prop{v}}}}
             {\object{v}}
}
{ \judgement {\propenv{}} 
             {\hastype {\assocexp {\e{m}} {\e{k}} {\e{v}}}
                       {\HMapc {\extendmandatoryset {\mandatory{}}{\k{}}{\t{v}}}}}
             {\filterset {\topprop{}} {\topprop{}}}
             {\emptyobject{}}
}

\end{mathpar}
\caption{HMap Typing Rules}
\end{figure*}
